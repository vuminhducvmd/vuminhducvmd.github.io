{%- comment -%}
Supported front-matter on each item:
  title (req)
  written_on (YYYY-MM-DD, req)
  tagline, description (opt)
  image (opt)
  link (opt)          # external URL or local HTML (/pages/.../demo.html)
  no_link (opt bool)  # true => non-clickable block

Caller may pass: href=... to force the target (we’ll honor that first).
{%- endcomment -%}

{%- assign coll = include.item.collection -%}
{%- assign name_wo_ext = include.item.basename_without_ext | default: include.item.name | split:'.' | first -%}
{%- assign fallback = '/pages/' | append: coll | append: '/' | append: name_wo_ext | append: '/' -%}

{%- assign auto_href = include.item.url | default: fallback -%}
{%- assign href = include.href | default: include.item.link | default: auto_href -%}
{%- assign has_link = include.item.no_link != true -%} 
{%- assign is_external = href contains '://' -%}

{%- capture inner -%}
  <div class="card-content">
    <h2 class="card-title">{{ include.item.title }}</h2>
    <p class="card-meta">
      <span class="card-date">{{ include.item.written_on | date: "%b %d, %Y" }}</span>
      {%- if include.item.tagline and include.item.tagline != blank -%}
        <span class="card-dot">•</span>
        <span class="card-tagline">#{{ include.item.tagline }}</span>
      {%- endif -%}
    </p>
    {%- if include.item.description and include.item.description != blank -%}
      <p class="card-desc">{{ include.item.description }}</p>
    {%- endif -%}
  </div>

  {%- if include.item.image and include.item.image != blank -%}
    <div class="card-image">
      {%- if include.item.image contains '://' -%}
        <img src="{{ include.item.image }}" alt="">
      {%- else -%}
        <img src="{{ include.item.image | relative_url }}" alt="">
      {%- endif -%}
    </div>
  {%- endif -%}
{%- endcapture -%}

{%- if has_link -%}
  {%- if is_external -%}
    <a class="card card-link" href="{{ href }}" target="_blank" rel="noopener noreferrer">{{ inner }}</a>
  {%- else -%}
    <a class="card card-link" href="{{ href | relative_url }}">{{ inner }}</a>
  {%- endif -%}
{%- else -%}
  <div class="card" aria-disabled="true">{{ inner }}</div>
{%- endif -%}
